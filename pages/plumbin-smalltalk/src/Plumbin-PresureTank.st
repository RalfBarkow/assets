Tile subclass: #PressureTank	instanceVariableNames: 'volume '	classVariableNames: ''	poolDictionaries: ''	category: 'Plumbin-Presure Tank'!PressureTank comment:'A PressureTank stores fluid while creating a back pressure due to traped compressed gas.'!!PressureTank methodsFor: 'accessing' stamp: 'ward 8/1/97 15:03'!capacity	"Answer the total capacity of the receiver."	^500.0! !!PressureTank methodsFor: 'accessing' stamp: 'ward 8/1/97 14:14'!emptyForm	"Answer a Form representing the receiver when empty."	^(Form	extent: 40@40	depth: 4	fromArray: #( 4294967295 4294967295 4294967295 4294967295 4294967295 4277071598 4008636142 4008636142 4008636142 4008636141 4277071598 4008636142 4008636142 4008636142 4008636141 4277071598 4008636142 4008636142 4008636142 4008636141 4277068049 286331153 286331153 286331153 287239917 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068168 2290649224 2290649224 2290649224 2283728621 4277068049 286331153 286331153 286331153 287239917 4277071598 4008636129 2290649224 518975214 4008636141 4277071598 4008636129 2290649224 518975214 4008636141 4277071598 4008636129 2290649224 518975214 4008636141 4277071598 4008636129 2290649224 518975214 4008636141 4277071598 4008632593 286331153 287239918 4008636141 3722304989 3722301832 2290649224 2283658717 3722304989)	offset: 0@0)! !!PressureTank methodsFor: 'accessing' stamp: 'ward 8/1/97 14:57'!form	"Answer a Form representing the receiver."	| aForm indicator bubble | 	aForm _ self emptyForm deepCopy.	indicator _ self indicator.	indicator _ indicator insetBy:		(0@((1-self indication) * indicator height) rounded corner: 0@0).	aForm fill: indicator fillColor: Color blue.	10 timesRepeat: 		[bubble _ (indicator left to: indicator right) atRandom @			(indicator top to: indicator bottom) atRandom.		aForm colorAt: bubble put: Color white].	^aForm! !!PressureTank methodsFor: 'accessing' stamp: 'ward 7/31/97 20:36'!indication	"Answer the portion of the indicator that is currently filled."	^(self capacity - volume) asFloat / self capacity! !!PressureTank methodsFor: 'accessing' stamp: 'ward 7/31/97 20:36'!indicator	"Answer a Rectangle for the visible fluid indicator."	^7@6 corner: 33@32! !!PressureTank methodsFor: 'accessing' stamp: 'ward 7/31/97 20:36'!volume	"Answer the unused volume of the receiver."	^volume! !!PressureTank methodsFor: 'accessing' stamp: 'ward 7/31/97 20:36'!volume: aNumber	"Set the unused volume of the receiver."	^volume _ aNumber! !!PressureTank methodsFor: 'simulating' stamp: 'ward 7/31/97 20:36'!bottomFlow	"Answer the fluid flow out the bottom of the receiver."	^self bottomPressure - bottom topPressure! !!PressureTank methodsFor: 'simulating' stamp: 'ward 7/31/97 20:36'!bottomPressure	"Answer the fluid pressure at the bottom of the receiver."	^self capacity / volume! !!PressureTank methodsFor: 'simulating' stamp: 'ward 8/1/97 08:10'!computeStep	volume _ (volume + self bottomFlow max: 1.0) min: self capacity.	self changed.	self resetLoopCheck.	bottom topChanged.! !!PressureTank methodsFor: 'defaults' stamp: 'ward 7/31/97 20:36'!defaultControllerClass	"Answer the class of the default controller for the receiver."	^PressureTankController! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!PressureTank class	instanceVariableNames: ''!!PressureTank class methodsFor: 'instance creation' stamp: 'ward 7/31/97 20:36'!new	| aTile | 	aTile _ super new.	aTile volume: aTile capacity.	^aTile! !TileController subclass: #PressureTankController	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'Plumbin-Presure Tank'!PressureTankController comment:'A PressureTankController steps its model''s calculation of fluid volume.'!!PressureTankController methodsFor: 'control defaults' stamp: 'ward 8/1/97 14:59'!controlActivity	super controlActivity.	model notNil ifTrue: [model computeStep].! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!PressureTankController class	instanceVariableNames: ''!